<!DOCTYPE html>
<html class="h-100">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="description" content="">
        <meta name="author" content="">

        <title>Huntress - Log4Shell Tester</title>

        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    </head>

    <body class="d-flex flex-column h-100">

        <!-- Github Corners - https://tholman.com/github-corners/ -->
        <a href="https://github.com/huntresslabs/log4shell-tester" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

        <main class="flex-shrink-0">
            <div class="container">
                <h1>Huntress Log4Shell Vulnerability Tester</h1>

                <p>
                    Our team is continuing to investigate <a href="https://www.huntress.com/blog/rapid-response-critical-rce-vulnerability-is-affecting-java">CVE-2021-44228</a>, a critical vulnerability that’s
                    affecting a Java logging package log4j which is used in a significant amount of software.
                    The source code for this tool is available on GitHub at <a href="https://github.com/huntresslabs/log4shell-tester">huntresslabs/log4shell-tester</a>.
                </p>

                <p>
                    This site can help you test whether your applications are vulnerable to Log4Shell
                    (CVE-2021-44228). <strong>Here's how to use it:</strong>

                    <ul>
                        <li>
                            You simply <strong>copy and paste</strong> the generated JNDI syntax
                            (the code block <code>${jndi[:]ldap[:]//....</code> presented below)
                            into anything (application input boxes, frontend site form fields,
                            logins such as username inputs, or if you are bit more technical,
                            even User-Agent or X-Forwarded-For or other customizable HTTP headers).
                        </li>
                        <li>
                            Check the <a href="/view/GUID">results</a> page to see if it received
                            any connection, and verify the detected IP address and timestamp, to
                            correlate with when you tested any service.
                        </li>
                        <li>
                            <strong>If you see an entry</strong>, a connection was made and
                            <strong>the application you tested is vulnerable.</strong>
                        </li>
                    </ul>
                </p>

                <div class="alert alert-danger" role="alert">
                    The following payload should only be used with systems which
                    you have explicit permission to test. If you find any vulnerable
                    applications or libraries, you should exercise responsible
                    disclosure to minimize any potential fallout due to the vulnerability!
                    This tool was created with the intention of helping the community
                    quickly identify vulnerable applications in <strong>your own</strong>
                    networks only.
                </div>

                <p>
                    Please know that <strong>a negative test does not guarantee that your application is patched.</strong>
                    The tool is designed to offer a simpler means of testing and is intended for testing
                    purposes only—it should only be used on systems you are authorized to test. If you
                    find any vulnerabilities, please follow <a href="https://www.cisa.gov/coordinated-vulnerability-disclosure-process">responsible disclosure</a> guidelines.
                </p>

                <p>
                    Your unique identifier is: <code>GUID</code>. You can use the
                    payload below for testing:
                    <div style="text-align: center">
                        <pre id="payload">PAYLOAD</pre>
                        <button class="btn btn-primary" onclick="copyText();">Copy Code</button>
                        <!-- Styles added to prevent button are content below from shifting layout in undesired ways -->
                        <span id="copy-confirmed" style="min-width: 60px; display: inline-block; margin-left: 8px;"></span>
                    </div>
                </p>

                <p>
                    <a href="/view/GUID" class="btn btn-primary" style="width: 100%">View Connections</a>
                </p>

                <h2>Technical Details</h2>

                <p>
                    The tool works by generating a random unique identifier which you can use when testing
                    input fields. If an input field or application is vulnerable, it will reach out to
                    this website over LDAP. Our LDAP server will immediately terminate the connection, and
                    log it for a short time. <strong>This tool will not actually run any code on your systems.</strong>
                </p>
            </div>
        </main>

        <footer class="footer mt-auto py-3 bg-light">
            <div class="container">
                <span class="text-muted">Created by <a href="https://twitter.com/calebjstewart">@calebjstewart</a>, <a href="https://www.linkedin.com/in/jslagle/">Jason Slagle</a> and <a href="https://twitter.com/_JohnHammond">@_JohnHammond</a>.</span>
            </div>
        </footer>

        <script>
          function copyText() {
            /* Get the code text */
            var copyText = document.getElementById("payload").textContent;
             /* Copy the text inside the text field */
            navigator.clipboard.writeText(copyText);
            /* Calls the function immediately below */
            confirmCopied();
          }

          function confirmCopied(){
            /* Get the notification element */
            var notification = document.getElementById("copy-confirmed");
            /* Let the user know the text has been successfully copied */
            notification.innerHTML = "Copied!";
            /* Clear the notification */
            setTimeout(function(){
              notification.innerHTML = "";
            }, 3000);
          }
        </script>
    </body>
</html>
